#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\begin_preamble
\usepackage{matlab-prettifier}
\usepackage{geometry}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\listings_params "style={Matlab-editor}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Furuta Pendulum Virtual Laboratory Experiment
\end_layout

\begin_layout Author
Filippo Badalamenti (Occasional FT, CID: 01998569)
\end_layout

\begin_layout Standard
This paper will follow the structure presented in the assignment.
 All the Matlab code and file used will be also provided through the following
 link: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

https://github.com/fil-bad/Furuta_pendulum
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
setcounter{part}{1}
\end_layout

\end_inset


\end_layout

\begin_layout Part
Derivation of the model
\end_layout

\begin_layout Section
From Lagrange equation to mechanical models
\end_layout

\begin_layout Standard
Without going much deeper, we have one main equation for the Lagrangian
 mechanics: 
\begin_inset Formula 
\[
L\left(q\left(t\right),\dot{q}\left(t\right)\right)=T\left(q\left(t\right),\dot{q}\left(t\right)\right)-V\left(q\left(t\right)\right)
\]

\end_inset

while the generalized coordinates in our case are: 
\begin_inset Formula $\left(q,\dot{q}\right)=\left(\begin{bmatrix}\theta\left(t\right) & \alpha\left(t\right)\end{bmatrix},\begin{bmatrix}\dot{\theta}\left(t\right) & \dot{\alpha}\left(t\right)\end{bmatrix}\right)$
\end_inset

 .
 In our case, the Lagrangian equation is:
\begin_inset Formula 
\begin{multline*}
L=\frac{1}{2}J_{arm}\dot{\theta}^{2}+\frac{1}{2}J_{p}\dot{\alpha}^{2}+\frac{1}{2}m_{p}\left(-\cos\left(\theta\right)\sin\left(\alpha\right)\dot{\theta}l_{p}-\sin\left(\theta\right)\cos\left(\alpha\right)\dot{\alpha}l_{p}-\sin\left(\theta\right)\dot{\theta}r\right)^{2}+\\
+\frac{1}{2}m_{p}\left(-\sin\left(\theta\right)\sin\left(\alpha\right)\dot{\theta}l_{p}+\cos\left(\theta\right)\cos\left(\alpha\right)\dot{\alpha}l_{p}+\cos\left(\theta\right)\dot{\theta}r\right)^{2}+\frac{1}{2}m_{p}\sin\left(\alpha\right)^{2}\dot{\alpha}^{2}l_{p}^{2}+m_{p}\cos\left(\alpha\right)gl_{p}
\end{multline*}

\end_inset


\end_layout

\begin_layout Standard
Finally, the Euler-Lagrange equation can be expressed as:
\begin_inset Formula 
\[
\frac{d}{dt}\frac{\partial L}{\partial\dot{q}}-\frac{\partial L}{\partial q}=\tau
\]

\end_inset


\end_layout

\begin_layout Standard
For this reason, we get two equations in column:
\begin_inset Formula 
\[
\begin{bmatrix}\frac{d}{dt}\frac{\partial L}{\partial\dot{\theta}}-\frac{\partial L}{\partial\theta}\\
\\
\frac{d}{dt}\frac{\partial L}{\partial\dot{\alpha}}-\frac{\partial L}{\partial\alpha}
\end{bmatrix}=\tau
\]

\end_inset

Then, we can calculate each partial derivative of the Lagrangian equation,
 that are:
\size footnotesize

\begin_inset Formula 
\begin{align*}
\boldsymbol{\frac{\partial L}{\partial\theta}} & \boldsymbol{=}m_{p}\left(-\cos\left(\theta\right)\sin\left(\alpha\right)\dot{\theta}l_{p}-\sin\left(\theta\right)\cos\left(\alpha\right)\dot{\alpha}l_{p}-\sin\left(\theta\right)\dot{\theta}r\right)\left(\sin\left(\theta\right)\sin\left(\alpha\right)\dot{\theta}l_{p}-\cos\left(\theta\right)\cos\left(\alpha\right)\dot{\alpha}l_{p}-\cos\left(\theta\right)\dot{\theta}r\right)+\\
 & +m_{p}\left(-\sin\left(\theta\right)\sin\left(\alpha\right)\dot{\theta}l_{p}+\cos\left(\theta\right)\cos\left(\alpha\right)\dot{\alpha}l_{p}+\cos\left(\theta\right)\dot{\theta}r\right)\left(-\cos\left(\theta\right)\sin\left(\alpha\right)\dot{\theta}l_{p}-\sin\left(\theta\right)\cos\left(\alpha\right)\dot{\alpha}l_{p}-\sin\left(\theta\right)\dot{\theta}r\right)=\\
\dots & \boldsymbol{=}-2l_{p}m_{p}\sin\left(\alpha\right)\left(2\sin\left(\theta\right)^{2}-1\right)\left(r\dot{\theta}+l_{p}\cos\left(\alpha\right)\dot{\alpha}\right)\dot{\theta}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\begin{eqnarray*}
\boldsymbol{\frac{\partial L}{\partial\dot{\theta}}} & = & J_{\mathrm{arm}}\dot{\theta}+m_{p}\left(r\cos\left(\theta\right)+l_{p}\sin\left(\alpha\right)\sin\left(\theta\right)\right)\left(r\cos\left(\theta\right)\dot{\theta}+l_{p}\sin\left(\alpha\right)\sin\left(\theta\right)\dot{\theta}+l_{p}\cos\left(\alpha\right)\cos\left(\theta\right)\dot{\alpha}\right)+\\
 & + & m_{p}\left(r\sin\left(\theta\right)+l_{p}\sin\left(\alpha\right)\cos\left(\theta\right)\right)\left(r\sin\left(\theta\right)\dot{\theta}+l_{p}\cos\left(\alpha\right)\sin\left(\theta\right)\dot{\alpha}+l_{p}\sin\left(\alpha\right)\cos\left(\theta\right)\dot{\theta}\right)\\
\boldsymbol{\frac{d}{dt}\left(\frac{\partial L}{\partial\dot{\theta}}\right)} & = & J_{\mathrm{arm}}\ddot{\theta}+l_{p}^{2}m_{p}\ddot{\theta}+m_{p}r^{2}\ddot{\theta}-l_{p}^{2}m_{p}\sin\left(2\theta\right)\dot{\alpha}^{2}-l_{p}^{2}m_{p}\cos\left(\alpha\right)^{2}\ddot{\theta}-l_{p}m_{p}r\sin\left(\alpha\right)\dot{\alpha}^{2}+l_{p}m_{p}r\cos\left(\alpha\right)\ddot{\alpha}-\\
 & - & 4l_{p}m_{p}r\sin\left(\alpha\right)\dot{\theta}^{2}+8l_{p}m_{p}r\sin\left(\alpha\right)\cos\left(\theta\right)^{2}\dot{\theta}^{2}+4l_{p}^{2}m_{p}\cos\left(\alpha\right)^{2}\cos\left(\theta\right)\sin\left(\theta\right)\dot{\alpha}^{2}+4l_{p}^{2}m_{p}\cos\left(\alpha\right)\sin\left(\alpha\right)\cos\left(\theta\right)^{2}\dot{\theta}\dot{\alpha}+\\
 & + & 4l_{p}m_{p}r\sin\left(\alpha\right)\cos\left(\theta\right)\sin\left(\theta\right)\ddot{\theta}+2l_{p}^{2}m_{p}\cos\left(\alpha\right)\sin\left(\alpha\right)\cos\left(\theta\right)\sin\left(\theta\right)\ddot{\alpha}+4l_{p}m_{p}r\cos\left(\alpha\right)\cos\left(\theta\right)\sin\left(\theta\right)\dot{\theta}\dot{\alpha}
\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Standard
Once calculated, we can assemble the two equations to get: 
\end_layout

\begin_layout Standard

\size footnotesize
\begin_inset Formula 
\begin{align*}
\boldsymbol{\frac{d}{dt}\frac{\partial L}{\partial\dot{\theta}}-\frac{\partial L}{\partial\theta}} & = & J_{\mathrm{arm}}\ddot{\theta}+l_{p}^{2}m_{p}\ddot{\theta}+m_{p}r^{2}\ddot{\theta}-l_{p}^{2}m_{p}\sin\left(2\theta\right)\dot{\alpha}^{2}-l_{p}^{2}m_{p}\cos\left(\alpha\right)^{2}\ddot{\theta}-l_{p}m_{p}r\sin\left(\alpha\right)\dot{\alpha}^{2}+l_{p}m_{p}r\cos\left(\alpha\right)\ddot{\alpha}-\\
 & - & 2l_{p}m_{p}r\sin\left(\alpha\right)\dot{\theta}^{2}+l_{p}^{2}m_{p}\sin\left(2\alpha\right)\dot{\theta}\dot{\alpha}+4l_{p}m_{p}r\sin\left(\alpha\right)\cos\left(\theta\right)^{2}\dot{\theta}^{2}+4l_{p}^{2}m_{p}\cos\left(\dot{\alpha}\right)^{2}\cos\left(\theta\right)\sin\left(\theta\right)\dot{\alpha}^{2}+\\
 & + & 4l_{p}m_{p}r\sin\left(\alpha\right)\cos\left(\theta\right)\sin\left(\theta\right)\ddot{\theta}+2l_{p}^{2}m_{p}\cos\left(\alpha\right)\sin\left(\alpha\right)\cos\left(\theta\right)\sin\left(\theta\right)\ddot{\alpha}+4l_{p}m_{p}r\cos\left(\alpha\right)\cos\left(\theta\right)\sin\left(\theta\right)\dot{\theta}\dot{\alpha}
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
The same can be done for the 
\begin_inset Formula $\alpha\left(t\right)$
\end_inset

 variable, leading to the equation:
\size footnotesize

\begin_inset Formula 
\begin{align*}
\boldsymbol{\frac{\partial L}{\partial\alpha}} & = & m_{p}\sin\left(\alpha\right)l_{p}^{2}\cos\left(\alpha\right)\dot{\theta}^{2}+2m_{p}r\cos\left(\theta\right)\sin\left(\theta\right)l_{p}\cos\left(\alpha\right)\dot{\theta}^{2}+4m_{p}\cos\left(\theta\right)\sin\left(\theta\right)l_{p}^{2}\cos\left(\alpha\right)^{2}\dot{\theta}\dot{\alpha}-\\
 & - & 2m_{p}\cos\left(\theta\right)\sin\left(\theta\right)l_{p}^{2}\dot{\theta}\dot{\alpha}-m_{p}r\sin\left(\alpha\right)l_{p}\dot{\theta}\dot{\alpha}-gm_{p}\sin\left(\alpha\right)l_{p}
\end{align*}

\end_inset


\begin_inset Formula 
\begin{align*}
\boldsymbol{\frac{\partial L}{\partial\dot{\alpha}}} & = & J_{p}\dot{\alpha}+l_{p}^{2}m_{p}\dot{\alpha}+l_{p}m_{p}r\cos\left(\alpha\right)\dot{\theta}+\frac{1}{2}l_{p}^{2}m_{p}\sin\left(2\alpha\right)\sin\left(2\theta\right)\dot{\theta}\\
\boldsymbol{\frac{d}{dt}\left(\frac{\partial L}{\partial\dot{\alpha}}\right)} & = & J_{p}\ddot{\alpha}+l_{p}^{2}m_{p}\ddot{\alpha}+l_{p}m_{p}r\cos\left(\alpha\right)\ddot{\theta}+l_{p}^{2}m_{p}\cos\left(\alpha\right)\sin\left(\alpha\right)\sin\left(2\theta\right)\ddot{\theta}+\\
 & + & l_{p}^{2}m_{p}\sin\left(2\theta\right)\left(2\cos\left(\alpha\right)^{2}-1\right)\dot{\theta}\dot{\alpha}-l_{p}m_{p}r\sin\left(\alpha\right)\dot{\theta}\dot{\alpha}+2l_{p}^{2}m_{p}\cos\left(\alpha\right)\sin\left(\alpha\right)\cos\left(2\theta\right)\dot{\theta}^{2}
\end{align*}

\end_inset


\size default
 
\size footnotesize

\begin_inset Formula 
\begin{alignat*}{2}
\boldsymbol{\frac{d}{dt}\frac{\partial L}{\partial\dot{\alpha}}-\frac{\partial L}{\partial\alpha}} & = & J_{p}\ddot{\alpha}+l_{p}^{2}m_{p}\ddot{\alpha}-\frac{1}{2}l_{p}^{2}m_{p}\sin\left(2\alpha\right)\dot{\theta}^{2}+gl_{p}m_{p}\sin\left(\alpha\right)+l_{p}^{2}m_{p}\sin\left(2\alpha\right)\cos\left(2\theta\right)\dot{\theta}^{2}+\\
 & + & l_{p}m_{p}r\cos\left(\alpha\right)\ddot{\theta}+\frac{1}{2}l_{p}^{2}m_{p}\sin\left(2\alpha\right)\sin\left(2\theta\right)\ddot{\theta}-l_{p}m_{p}r\cos\left(\alpha\right)\sin\left(2\theta\right)\dot{\theta}^{2}
\end{alignat*}

\end_inset


\end_layout

\begin_layout Standard
If we equal the 
\begin_inset Formula $\tau=\begin{bmatrix}\tau_{m}-B_{arm}\dot{\theta}\left(t\right) & -B_{p}\dot{\alpha}\left(t\right)\end{bmatrix}^{T}$
\end_inset

 vector to the results found above, we finally get the non linear model
 expressed in the equations (7) and (8) of the assignment.
\end_layout

\begin_layout Section
Matricial model
\end_layout

\begin_layout Standard
Our model can be rewritten in the form: 
\begin_inset Formula 
\[
D\left(q\left(t\right)\right)\ddot{q}\left(t\right)+C\left(q\left(t\right),\dot{q}\left(t\right)\right)\dot{q}\left(t\right)+g\left(q\left(t\right)\right)=\tau
\]

\end_inset


\end_layout

\begin_layout Standard
where the 
\begin_inset Formula $C\left(q\left(t\right),\dot{q}\left(t\right)\right)$
\end_inset

 matrix is not uniquely defined due to mixed products in the equations;
 a possible representation is given by:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{gather*}
D=\begin{bmatrix}m_{p}r^{2}+m_{p}l_{p}^{2}-m_{p}l_{p}^{2}\cos\left(\alpha\right)^{2}+J_{arm} & m_{p}\cos\left(\alpha\right)l_{p}r\\
m_{p}\cos\left(\alpha\right)l_{p}r & J_{p}+m_{p}l_{p}^{2}
\end{bmatrix}\\
C=\begin{bmatrix}2m_{p}\cos\left(\alpha\right)\dot{\alpha}l_{p}^{2}\sin\left(\alpha\right) & -m_{p}\sin\left(\alpha\right)\dot{\alpha}l_{p}r\\
-m_{p}\cos\left(\alpha\right)\dot{\theta}l_{p}^{2}\sin\left(\alpha\right) & 0
\end{bmatrix}\ g=\begin{bmatrix}0\\
m_{p}g\sin\left(\alpha\right)l_{p}
\end{bmatrix}
\end{gather*}

\end_inset


\end_layout

\begin_layout Part
Linear System Analysis
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
setcounter{section}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Linearising the model
\end_layout

\begin_layout Standard
The matricial equation is not linear; in fact, each matrix depends from
 the coordinates 
\begin_inset Formula $q\left(t\right)$
\end_inset

 (the angular position of each section of the pendulum) and/or from their
 derivative 
\begin_inset Formula $\dot{q}\left(t\right)$
\end_inset

 (the angular speed).
 For this reason, we can linearize the model in its two equilibrium points
 (as we will see from further analysis), the 
\emph on
downward
\emph default
 position and the 
\emph on
upward
\emph default
 position.
 The resulting system is a linear 2-DOF one that can be analysed through
 the classical approach for mechanical systems.
\end_layout

\begin_layout Subsection
Downward position, 
\begin_inset Formula $\left(\theta,\alpha\right)=\left(0,0\right)$
\end_inset


\end_layout

\begin_layout Standard
As we know, the linearization around a point of a function is given by:
 
\begin_inset Formula $f\left(x\right)\thickapprox f\left(x_{0}\right)+f'\left(x_{0}\right)\left(x-x_{0}\right)$
\end_inset

.
 For this reason, we can approximate the trigonometric functions as: 
\begin_inset Formula 
\[
\begin{cases}
\left.\sin\left(x\right)\right|_{x_{0}=0}\thickapprox\sin\left(0\right)+\cos\left(0\right)\left(x-0\right)=x\\
\left.\cos\left(x\right)\right|_{x_{0}=0}\thickapprox\cos\left(0\right)+\sin\left(0\right)\left(x-0\right)=1
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
that in the matrices become:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{gather*}
D=\begin{bmatrix}m_{p}r^{2}+m_{p}l_{p}^{2}-m_{p}l_{p}^{2}\left(1\right)^{2}+J_{arm} & m_{p}\left(1\right)l_{p}r\\
m_{p}\left(1\right)l_{p}r & J_{p}+m_{p}l_{p}^{2}
\end{bmatrix}\\
C=\begin{bmatrix}2m_{p}\left(1\right)\dot{\alpha}l_{p}^{2}\left(\alpha\right) & -m_{p}\left(\alpha\right)\dot{\alpha}l_{p}r\\
-m_{p}\left(1\right)\dot{\theta}l_{p}^{2}\left(\alpha\right) & 0
\end{bmatrix}g=\begin{bmatrix}0\\
m_{p}g\left(\alpha\right)l_{p}
\end{bmatrix}
\end{gather*}

\end_inset


\end_layout

\begin_layout Standard
Substituting the values in the matrices, they become constant ones:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D=\begin{bmatrix}m_{p}r^{2}+J_{arm} & m_{p}l_{p}r\\
m_{p}l_{p}r & J_{p}+m_{p}l_{p}^{2}
\end{bmatrix}C=\begin{bmatrix}0 & 0\\
0 & 0
\end{bmatrix}g=\begin{bmatrix}0\\
0
\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Subsection
Upward position, 
\begin_inset Formula $\left(\theta,\alpha\right)=\left(0,\pi\right)$
\end_inset


\end_layout

\begin_layout Standard
As seen above, the trigonometric functions can be approximated with: 
\begin_inset Formula 
\[
\begin{cases}
\left.\sin\left(x\right)\right|_{x_{0}=\pi}\thickapprox\sin\left(\pi\right)+\cos\left(\pi\right)\left(x-\pi\right)=-x+\pi\\
\left.\cos\left(x\right)\right|_{x_{0}=\pi}\thickapprox\cos\left(\pi\right)+\sin\left(\pi\right)\left(x-\pi\right)=-1
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
Substituting the values in the matrices, they become:
\begin_inset Formula 
\begin{gather*}
D=\begin{bmatrix}m_{p}r^{2}+m_{p}l_{p}^{2}-m_{p}l_{p}^{2}\left(-1\right)^{2}+J_{arm} & m_{p}\left(-1\right)l_{p}r\\
m_{p}\left(-1\right)l_{p}r & J_{p}+m_{p}l_{p}^{2}
\end{bmatrix}\\
C=\begin{bmatrix}2m_{p}\left(-1\right)\dot{\alpha}l_{p}^{2}\left(-\alpha+\pi\right) & -m_{p}\left(-\alpha+\pi\right)\dot{\alpha}l_{p}r\\
-m_{p}\left(-1\right)\dot{\theta}l_{p}^{2}\left(-\alpha+\pi\right) & 0
\end{bmatrix}g=\begin{bmatrix}0\\
m_{p}g\left(-\alpha+\pi\right)l_{p}
\end{bmatrix}
\end{gather*}

\end_inset

And finally:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D=\begin{bmatrix}m_{p}r^{2}+J_{arm} & -m_{p}l_{p}r\\
-m_{p}l_{p}r & J_{p}+m_{p}l_{p}^{2}
\end{bmatrix}\ C=\begin{bmatrix}0 & 0\\
0 & 0
\end{bmatrix}\ g=\begin{bmatrix}0\\
0
\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Section
State space representation 
\end_layout

\begin_layout Standard
Due to the linearization around equilibrium points, both 
\begin_inset Formula $C$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

 matrices become null ones.
 In particular, the equations become:
\begin_inset Formula 
\begin{align*}
D_{(0,0)}\ddot{q}\left(t\right)=\tau & \ \ ,\ \ D_{(0,\pi)}\ddot{q}\left(t\right)=\tau
\end{align*}

\end_inset


\end_layout

\begin_layout Standard
For this reason, if the matrix 
\begin_inset Formula $D$
\end_inset

 is invertible – that means 
\begin_inset Formula $\det\left(D\right)\neq0$
\end_inset

 –, we can invert it and get an expression for the second order derivatives
 of 
\begin_inset Formula $q\left(t\right)$
\end_inset

 (notice that each term of the determinant is by physical definition a non
 negative term, hence):
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\begin{cases}
\ddot{q}_{down}\left(t\right)=D_{(0,0)}^{-1}\tau=\begin{pmatrix}\frac{J_{p}+l_{p}^{2}m_{p}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}} & -\frac{rm_{p}l_{p}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}}\\
-\frac{rm_{p}l_{p}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}} & \frac{r^{2}m_{p}+J_{arm}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}}
\end{pmatrix}\begin{pmatrix}\tau_{m}-B_{arm}\dot{\theta}\left(t\right)\\
-B_{p}\dot{\alpha}\left(t\right)
\end{pmatrix}\\
\ddot{q}_{up}\left(t\right)=D_{(0,\pi)}^{-1}\tau=\begin{pmatrix}\frac{J_{p}+l_{p}^{2}m_{p}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}} & \frac{rm_{p}l_{p}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}}\\
\frac{rm_{p}l_{p}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}} & \frac{r^{2}m_{p}+J_{arm}}{l_{p}^{2}J_{arm}m_{p}+r^{2}m_{p}J_{p}+J_{arm}J_{p}}
\end{pmatrix}\begin{pmatrix}\tau_{m}-B_{arm}\dot{\theta}\left(t\right)\\
-B_{p}\dot{\alpha}\left(t\right)
\end{pmatrix}
\end{cases}
\]

\end_inset


\end_layout

\begin_layout Standard
We can now introduce the state vectors 
\begin_inset Formula $\begin{bmatrix}x_{1}\left(t\right) & x_{2}\left(t\right) & x_{3}\left(t\right) & x_{4}\left(t\right)\end{bmatrix}^{T}=\begin{bmatrix}\theta\left(t\right) & \alpha\left(t\right) & \dot{\theta}\left(t\right) & \dot{\alpha}\left(t\right)\end{bmatrix}^{T}$
\end_inset

 and 
\begin_inset Formula $\begin{bmatrix}x_{1}\left(t\right) & x_{2}\left(t\right) & x_{3}\left(t\right) & x_{4}\left(t\right)\end{bmatrix}^{T}=\begin{bmatrix}\theta\left(t\right) & \alpha\left(t\right)-\pi & \dot{\theta}\left(t\right) & \dot{\alpha}\left(t\right)\end{bmatrix}^{T}$
\end_inset

 for downward and upward positions respectively.
\end_layout

\begin_layout Standard
In this case, the systems become (we keep the matrices 
\begin_inset Formula $D$
\end_inset

 in the shortest form, since they have only constants): 
\begin_inset Formula 
\[
down:\ \ \dot{x}=\begin{bmatrix}\dot{x}_{1}\\
\dot{x}_{2}\\
\dot{x}_{3}\\
\dot{x}_{4}
\end{bmatrix}=\begin{bmatrix}x_{3}\\
x_{4}\\
D_{(0,0)}^{-1}\begin{pmatrix}\tau_{m}-B_{arm}x_{3}\\
-B_{p}x_{4}
\end{pmatrix}
\end{bmatrix}\ \ ,\ \ \tau_{m}=\frac{\eta_{g}K_{g}\eta_{m}K_{t}\left(u-K_{g}K_{m}x_{3}\right)}{R_{m}}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
D^{-1}g=\begin{pmatrix}-\frac{rg\cos\left(α\right)\sin\left(α\right)m_{p}^{2}l_{p}^{2}}{\left(l_{p}^{2}m_{p}+J_{p}\right)\left(r^{2}m_{p}+l_{p}^{2}m_{p}-l_{p}^{2}\cos^{2}\left(α\right)m_{p}+J_{arm}\right)-r^{2}\cos^{2}\left(α\right)m_{p}^{2}l_{p}^{2}}\\
\frac{g\sin\left(α\right)m_{p}l_{p}\left(r^{2}m_{p}+l_{p}^{2}m_{p}-l_{p}^{2}\cos^{2}\left(α\right)m_{p}+J_{arm}\right)}{\left(l_{p}^{2}m_{p}+J_{p}\right)\left(r^{2}m_{p}+l_{p}^{2}m_{p}-l_{p}^{2}\cos^{2}\left(α\right)m_{p}+J_{arm}\right)-r^{2}\cos^{2}\left(α\right)m_{p}^{2}l_{p}^{2}}
\end{pmatrix}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left(\begin{array}{cccc}
0 & \frac{gl_{p}^{2}m_{p}^{2}r}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & -\frac{\left(m_{p}l_{p}^{2}+J_{p}\right)\left(B_{arm}+\frac{\eta_{g}\eta_{m}K_{g}^{2}K_{m}K_{t}}{R_{m}}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & \frac{B_{p}l_{p}m_{p}r}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}}\\
0 & -\frac{gl_{p}m_{p}\left(m_{p}r^{2}J_{arm}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & \frac{l_{p}m_{p}r\left(B_{arm}+\frac{\eta_{g}\eta_{m}K_{g}^{2}K_{m}K_{t}}{R_{m}}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & -\frac{B_{p}\left(m_{p}r^{2}+J_{arm}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}}
\end{array}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
From the nonlinear system analysis, we know that given a system 
\begin_inset Formula $\dot{x}=f\left(x,u\right)$
\end_inset

, we can linearize it around equilibrium points using the jacobian function
 over the system equations; the result is then: 
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\dot{\delta x}=\frac{\partial}{\partial x}f\left(x_{e},u_{e}\right)\delta x+\frac{\partial}{\partial u}f\left(x_{e},u_{e}\right)\delta u
\]

\end_inset


\end_layout

\begin_layout Standard
For this reason, we can get a linear system, where:
\begin_inset Formula 
\begin{gather*}
A=\frac{\partial}{\partial x}f\left(x_{e},u_{e}\right)=\begin{bmatrix}0 & 0 & 1 & 0\\
0 & 0 & 0 & 1\\
0 & \frac{gl_{p}^{2}m_{p}^{2}r}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & -\frac{\left(m_{p}l_{p}^{2}+J_{p}\right)\left(B_{arm}+\frac{\eta_{g}\eta_{m}K_{g}^{2}K_{m}K_{t}}{R_{m}}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & \frac{B_{p}l_{p}m_{p}r}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}}\\
0 & -\frac{gl_{p}m_{p}\left(m_{p}r^{2}J_{arm}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & \frac{l_{p}m_{p}r\left(B_{arm}+\frac{\eta_{g}\eta_{m}K_{g}^{2}K_{m}K_{t}}{R_{m}}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}} & -\frac{B_{p}\left(m_{p}r^{2}+J_{arm}\right)}{J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}}
\end{bmatrix}\\
B=\frac{\partial}{\partial u}f\left(x_{e},u_{e}\right)=\begin{bmatrix}\begin{array}{c}
\frac{\eta_{g}\eta_{m}K_{g}K_{t}\left(m_{p}l_{p}^{2}+J_{p}\right)}{R_{m}\left(J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}\right)}\\
-\frac{\eta_{g}\eta_{m}K_{g}K_{t}l_{p}m_{p}r}{R_{m}\left(J_{arm}m_{p}l_{p}^{2}+J_{p}m_{p}r^{2}+J_{arm}J_{p}\right)}
\end{array}\end{bmatrix}
\end{gather*}

\end_inset


\end_layout

\end_body
\end_document
